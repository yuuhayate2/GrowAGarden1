-- Kuni Hub | Grow A Garden Pet Predictor (KRNL Compatible)
-- Final Fixed Version - Clean, Dark, and Smooth

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- Hatch Rates (Current Eggs Only)
local eggToPets = {
    ["Common Egg"] = {
        {name = "Golden Lab", chance = 33.33},
        {name = "Dog", chance = 33.33},
        {name = "Bunny", chance = 33.34},
    },
    ["Paradise Egg"] = {
        {name = "Ostrich", chance = 40},
        {name = "Peacock", chance = 30},
        {name = "Capybara", chance = 21},
        {name = "Scarlet Macaw", chance = 8},
        {name = "Mimic Octopus", chance = 1},
    },
    ["Oasis Egg"] = {
        {name = "Meerkat", chance = 45},
        {name = "Sand Snake", chance = 34.5},
        {name = "Axolotl", chance = 15},
        {name = "Hyacinth Macaw", chance = 5},
        {name = "Fennec Fox", chance = 0.5},
    },
    ["Dinosaur Egg"] = {
        {name = "Raptor", chance = 35},
        {name = "Triceratops", chance = 32.5},
        {name = "Stegosaurus", chance = 29},
        {name = "Pterodactyl", chance = 3},
        {name = "Brontosaurus", chance = 1},
        {name = "T-Rex", chance = 0.5},
    },
}

local function clearESP()
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Model") and obj:FindFirstChild("EggESP") then
            obj.EggESP:Destroy()
        end
    end
end

local function getRandomPet(eggName)
    local pets = eggToPets[eggName]
    if not pets then return "Unknown" end
    local r = math.random() * 100
    local sum = 0
    for _, pet in ipairs(pets) do
        sum = sum + pet.chance
        if r <= sum then
            return pet.name .. " (" .. pet.chance .. "%)"
        end
    end
    return pets[#pets].name .. " (" .. pets[#pets].chance .. "%)"
end

local function addESP(model, text)
    local part = model:FindFirstChildWhichIsA("BasePart")
    if not part then return end
    if part:FindFirstChild("EggESP") then return end

    local gui = Instance.new("BillboardGui")
    gui.Name = "EggESP"
    gui.Size = UDim2.new(0, 100, 0, 40)
    gui.StudsOffset = Vector3.new(0, 2.5, 0)
    gui.AlwaysOnTop = true
    gui.Parent = part

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.new(1, 1, 1)
    label.TextStrokeTransparency = 0.5
    label.Font = Enum.Font.Gotham
    label.TextScaled = true
    label.Text = text
    label.TextTransparency = 1
    label.Parent = gui

    TweenService:Create(label, TweenInfo.new(1), {TextTransparency = 0}):Play()
end

local function predictEggs()
    clearESP()
    for _, model in ipairs(workspace:GetDescendants()) do
        if model:IsA("Model") and eggToPets[model.Name] then
            local result = getRandomPet(model.Name)
            addESP(model, result)
        end
    end
end

-- Loading GUI
local loading = Instance.new("ScreenGui")
loading.Name = "KuniHubLoading"
loading.Parent = PlayerGui

local bg = Instance.new("Frame")
bg.Size = UDim2.new(1, 0, 1, 0)
bg.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
bg.Parent = loading

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 50)
title.Position = UDim2.new(0, 0, 0.25, -50)
title.Text = "Kuni Hub"
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.GothamBold
title.TextSize = 34
title.BackgroundTransparency = 1
title.Parent = bg

local loadingText = Instance.new("TextLabel")
loadingText.Size = UDim2.new(1, 0, 0, 30)
loadingText.Position = UDim2.new(0, 0, 0.35, 0)
loadingText.Text = "Loading Egg Predictor"
loadingText.TextColor3 = Color3.new(1, 1, 1)
loadingText.Font = Enum.Font.Gotham
loadingText.TextSize = 22
loadingText.BackgroundTransparency = 1
loadingText.Parent = bg

local percent = Instance.new("TextLabel")
percent.Size = UDim2.new(1, 0, 0, 25)
percent.Position = UDim2.new(0, 0, 0.4, 20)
percent.Text = "0%"
percent.TextColor3 = Color3.new(1, 1, 1)
percent.Font = Enum.Font.Gotham
percent.TextSize = 20
percent.BackgroundTransparency = 1
percent.Parent = bg

local bar = Instance.new("Frame")
bar.Size = UDim2.new(0.4, 0, 0, 10)
bar.Position = UDim2.new(0.3, 0, 0.5, 0)
bar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
bar.Parent = bg

local fill = Instance.new("Frame")
fill.Size = UDim2.new(0, 0, 1, 0)
fill.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
fill.Parent = bar

spawn(function()
    local duration = 3
    local start = tick()
    while tick() - start < duration do
        local progress = (tick() - start) / duration
        fill.Size = UDim2.new(progress, 0, 1, 0)
        percent.Text = tostring(math.floor(progress * 100)) .. "%"
        loadingText.Text = "Loading Egg Predictor" .. string.rep(".", math.floor(tick() % 4))
        RunService.RenderStepped:Wait()
    end
    fill.Size = UDim2.new(1, 0, 1, 0)
    percent.Text = "100%"
    wait(0.5)
    loading:Destroy()

    -- SHOW MAIN GUI
    local main = Instance.new("ScreenGui")
    main.Name = "KuniHubGUI"
    main.Parent = PlayerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 260, 0, 160)
    frame.Position = UDim2.new(0.02, 0, 0.35, 0)
    frame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    frame.Active = true
    frame.Draggable = true
    frame.Parent = main

    local label = Instance.new("TextLabel")
    label.Text = "Pet Predictor by Kuni"
    label.Size = UDim2.new(1, -10, 0, 25)
    label.Position = UDim2.new(0, 5, 0, 5)
    label.Font = Enum.Font.GothamBold
    label.TextColor3 = Color3.fromRGB(0, 200, 255)
    label.TextSize = 18
    label.BackgroundTransparency = 1
    label.Parent = frame

    local predict = Instance.new("TextButton")
    predict.Size = UDim2.new(0.9, 0, 0, 35)
    predict.Position = UDim2.new(0.05, 0, 0, 40)
    predict.Text = "Predict Pets"
    predict.Font = Enum.Font.GothamBold
    predict.TextSize = 16
    predict.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
    predict.TextColor3 = Color3.new(1, 1, 1)
    predict.Parent = frame

    predict.MouseButton1Click:Connect(function()
        predict.Text = "Please wait..."
        predictEggs()
        wait(1.5)
        predict.Text = "Predict Pets"
    end)
end)
